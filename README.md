# xops_test

Приложение сохраняет ссылки от пользователя в БД и возвращает уникальные посещенные домены за определенный промежуток времени.

# Установка
1. Склонировать репозиторий
2. Развернуть контейнер командой docker-compose up -d --build
3. Для запуска тестов установить виртуальное окружение и подтянуть зависимости (pip install -r requirements.txt внутри окружения)
4. Запустить pytest в консоли

# Запросы
Запрос POST http:127.0.0.1:8000/visited_links
```
{
   "links": [
      "https://ya.ru/",
      "https://ya.ru/search/?text=мемы+с+котиками",
      "https://sber.ru",
      "https://stackoverflow.com/questions/65724760/how-it-is"
       ]	
}
```
сохранит ссылки в БД, временем посещения ссылок будет время запроса к серверу - оно генерируется во время этого запроса и присваивается каждой записи, чтобы гарантировать одномоментность.
Каждая ссылка проверяется на валидность на этапе обработки запроса, сервис принимает только http и https ссылки, возвращая ошибку и статус 403:
```{
    "status": [
        "links должен содержать HTTP или HTTPS ссылки. Неверный ввод: {неверное значение от пользователя}"
    ]
}
```

Запрос GET http:127.0.0.1:8000/visited_domains?from=&to=
вернет список уникальных доменов, посещенных в эти временные промежутки. Или все уникальные домены, если промежуток не указан.
```
{
    "status": "ok",
    "domains": [
        "stackoverflow.com",
        "ya.ru",
        "sber.ru"
    ]
}
```
Параметры from и to принимают только положительные числовые значения, возвращая ошибку валидации в противном случае и статус 403:
```
{
    "status": [
        "{параметр} должен быть числом. Неверный ввод: {неверное значение}"
    ]
}
```
